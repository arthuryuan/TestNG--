
IF(MSVC)
  ADD_DEFINITIONS( -D_CRT_SECURE_NO_WARNINGS )
ENDIF(MSVC)


IF(NOT DEFINED TESTNGPPST_DISABLE_RC)
  SET(TESTNGPPST_DISABLE_RC FALSE)
ENDIF(NOT DEFINED TESTNGPPST_DISABLE_RC)

IF(NOT DEFINED TESTNGPPST_DISABLE_SANDBOX)
  SET(TESTNGPPST_DISABLE_SANDBOX FALSE)
ENDIF(NOT DEFINED TESTNGPPST_DISABLE_SANDBOX)

IF(TESTNGPPST_DISABLE_SANDBOX)
  ADD_DEFINITIONS(-DTESTNGPPST_DISABLE_SANDBOX=1)
ELSE(TESTNGPPST_DISABLE_SANDBOX)
  ADD_DEFINITIONS(-DTESTNGPPST_DISABLE_SANDBOX=0)
ENDIF(TESTNGPPST_DISABLE_SANDBOX)

IF(TESTNGPPST_DISABLE_RC)
  ADD_DEFINITIONS(-DTESTNGPPST_DISABLE_RC=1)
ELSE(TESTNGPPST_DISABLE_RC)
  ADD_DEFINITIONS(-DTESTNGPPST_DISABLE_RC=0)
ENDIF(TESTNGPPST_DISABLE_RC)

SET(TESTNGPPST_RC_SRCS
  ResourceCheckPoint.cpp 
)

SET(TESTNGPPST_SRCS
  Exception.cpp
  AssertionFailure.cpp 
  TestFixture.cpp
  TestSuiteDesc.cpp 
  TypeString.cpp 
  Formatter.cpp 
  OptionList.cpp 
  StringToOptions.cpp
  ConsoleState.cpp
  StupidTimer.cpp
)

IF(NOT TESTNGPPST_DISABLE_RC)
  SET(TESTNGPPST_SRCS
     ${TESTNGPPST_SRCS}
     ${TESTNGPPST_RC_SRCS}
  )
ENDIF(NOT TESTNGPPST_DISABLE_RC)

IF(MSVC)
  INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/src)
  SET(TESTNGPPST_SRCS ${TESTNGPPST_SRCS} GetOpt.c)
ENDIF(MSVC)

IF(MSVC)
  ADD_LIBRARY(testngppst STATIC ${TESTNGPPST_SRCS})
ELSE(MSVC)  
  ADD_LIBRARY(testngppst SHARED ${TESTNGPPST_SRCS})
ENDIF(MSVC)

INCLUDE_DIRECTORIES(BEFORE ${CMAKE_SOURCE_DIR}/include)


IF(MSVC)
  INSTALL(
   TARGETS testngppst
   ARCHIVE DESTINATION lib)
ELSE(MSVC)  
  INSTALL(
   TARGETS testngppst
   LIBRARY DESTINATION lib)
ENDIF(MSVC)

   


